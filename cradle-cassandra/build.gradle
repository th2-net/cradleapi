ext {
	driver_version = '4.15.0'
}

configurations.all {
	exclude group: 'com.esri.geometry'
	exclude group: 'org.apache.tinkerpop'
}

dependencies {
	compile project(":cradle-core")

	implementation 'com.exactpro.th2:task-utils:0.1.0'
	annotationProcessor "com.datastax.oss:java-driver-mapper-processor:${driver_version}"

	implementation "com.datastax.oss:java-driver-core:${driver_version}"
	implementation "com.datastax.oss:java-driver-query-builder:${driver_version}"
	implementation "com.datastax.oss:java-driver-mapper-processor:${driver_version}"
	implementation "com.datastax.oss:java-driver-mapper-runtime:${driver_version}"
	implementation 'io.prometheus:simpleclient_dropwizard:0.9.0'


	implementation 'io.netty:netty-handler'
		constraints {
			implementation('io.netty:netty-handler:4.1.89.Final') {
				because 'version specified in datastax driver does not pass vulnerability check'
			}
		}

	implementation 'com.fasterxml.jackson.core:jackson-databind'
		constraints {
			implementation( "com.fasterxml.jackson.core:jackson-databind:${jackson_version}") {
				because 'version specified in datastax driver does not pass vulnerability check'
			}
		}


	annotationProcessor 'io.netty:netty-handler'
	constraints {
		annotationProcessor( 'io.netty:netty-handler:4.1.89.Final') {
			because 'version specified in datastax driver does not pass vulnerability check'
		}
	}
	annotationProcessor 'com.fasterxml.jackson.core:jackson-databind'
	constraints {
		annotationProcessor( "com.fasterxml.jackson.core:jackson-databind:${jackson_version}") {
			because 'version specified in datastax driver does not pass vulnerability check'
		}
	}



	testImplementation 'org.testng:testng:7.1.0'
	testImplementation 'org.assertj:assertj-core:3.12.2'
}

def gen_dir = 'build/generated/sources/annotationProcessor/main'
sourceSets.main.java.srcDirs += [gen_dir]

compileJava {
	options.annotationProcessorGeneratedSourcesDirectory = file("${projectDir}/${gen_dir}")
}

test {
	useTestNG()
}

jar {
	manifest {
		attributes("Specification-Title": "Cradle Cassandra")
	}
}